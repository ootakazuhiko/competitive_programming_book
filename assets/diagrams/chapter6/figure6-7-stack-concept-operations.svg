<svg viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
  <title>図6-7：スタックの概念と操作</title>
  <desc>スタックデータ構造の基本概念とpush/pop操作の可視化</desc>

  <!-- Background -->
  <rect width="800" height="600" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" font-family="Inter, sans-serif" font-size="18" font-weight="bold" fill="#2c3e50">
    図6-7：スタックの概念と操作
  </text>
  
  <!-- Stack description -->
  <rect x="50" y="50" width="700" height="60" fill="#e8f4fd" stroke="#3498db" stroke-width="2" rx="5"/>
  <text x="70" y="75" font-family="Inter, sans-serif" font-size="14" font-weight="600" fill="#2980b9">
    📚 スタック（Stack）= 「後入れ先出し」(LIFO: Last In, First Out)
  </text>
  <text x="70" y="95" font-family="Inter, sans-serif" font-size="12" fill="#2980b9">
    本の積み重ねのように、最後に載せた本を最初に取る構造
  </text>
  
  <!-- Visual representation -->
  <g transform="translate(100, 140)">
    <!-- Stack base -->
    <rect x="0" y="200" width="150" height="10" fill="#34495e"/>
    
    <!-- Stack items -->
    <rect x="10" y="170" width="130" height="30" fill="#e74c3c" stroke="#c0392b" stroke-width="2" rx="3"/>
    <text x="75" y="190" text-anchor="middle" font-family="Inter, sans-serif" font-size="14" font-weight="bold" fill="white">
      データ4
    </text>
    
    <rect x="10" y="140" width="130" height="30" fill="#f39c12" stroke="#e67e22" stroke-width="2" rx="3"/>
    <text x="75" y="160" text-anchor="middle" font-family="Inter, sans-serif" font-size="14" font-weight="bold" fill="white">
      データ3
    </text>
    
    <rect x="10" y="110" width="130" height="30" fill="#27ae60" stroke="#229954" stroke-width="2" rx="3"/>
    <text x="75" y="130" text-anchor="middle" font-family="Inter, sans-serif" font-size="14" font-weight="bold" fill="white">
      データ2
    </text>
    
    <rect x="10" y="80" width="130" height="30" fill="#3498db" stroke="#2980b9" stroke-width="2" rx="3"/>
    <text x="75" y="100" text-anchor="middle" font-family="Inter, sans-serif" font-size="14" font-weight="bold" fill="white">
      データ1
    </text>
    
    <!-- Top pointer -->
    <path d="M 180 95 L 150 95" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="190" y="100" font-family="Inter, sans-serif" font-size="12" font-weight="600" fill="#2c3e50">
      TOP (先頭)
    </text>
    
    <!-- Labels -->
    <text x="75" y="40" text-anchor="middle" font-family="Inter, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
      スタックの構造
    </text>
    <text x="75" y="60" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" fill="#7f8c8d">
      最新のデータが一番上
    </text>
  </g>
  
  <!-- Operations -->
  <text x="400" y="150" font-family="Inter, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
    基本操作
  </text>
  
  <!-- Push operation -->
  <g transform="translate(320, 170)">
    <rect x="0" y="0" width="200" height="120" fill="#e8f5e8" stroke="#27ae60" stroke-width="2" rx="5"/>
    <text x="100" y="20" text-anchor="middle" font-family="Inter, sans-serif" font-size="14" font-weight="bold" fill="#27ae60">
      PUSH（追加）
    </text>
    
    <!-- Before push -->
    <g transform="translate(20, 30)">
      <rect x="0" y="40" width="60" height="15" fill="#3498db" rx="2"/>
      <rect x="0" y="25" width="60" height="15" fill="#27ae60" rx="2"/>
      <rect x="0" y="10" width="60" height="15" fill="#f39c12" rx="2"/>
      <text x="30" y="50" text-anchor="middle" font-family="Inter, sans-serif" font-size="8" fill="white">1</text>
      <text x="30" y="35" text-anchor="middle" font-family="Inter, sans-serif" font-size="8" fill="white">2</text>
      <text x="30" y="20" text-anchor="middle" font-family="Inter, sans-serif" font-size="8" fill="white">3</text>
    </g>
    
    <!-- Arrow -->
    <path d="M 90 70 L 110 70" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <!-- After push -->
    <g transform="translate(120, 30)">
      <rect x="0" y="40" width="60" height="15" fill="#3498db" rx="2"/>
      <rect x="0" y="25" width="60" height="15" fill="#27ae60" rx="2"/>
      <rect x="0" y="10" width="60" height="15" fill="#f39c12" rx="2"/>
      <rect x="0" y="-5" width="60" height="15" fill="#e74c3c" rx="2"/>
      <text x="30" y="50" text-anchor="middle" font-family="Inter, sans-serif" font-size="8" fill="white">1</text>
      <text x="30" y="35" text-anchor="middle" font-family="Inter, sans-serif" font-size="8" fill="white">2</text>
      <text x="30" y="20" text-anchor="middle" font-family="Inter, sans-serif" font-size="8" fill="white">3</text>
      <text x="30" y="5" text-anchor="middle" font-family="Inter, sans-serif" font-size="8" fill="white">4</text>
    </g>
    
    <text x="100" y="100" text-anchor="middle" font-family="Inter, sans-serif" font-size="11" fill="#27ae60">
      stack.append(4)
    </text>
  </g>
  
  <!-- Pop operation -->
  <g transform="translate(550, 170)">
    <rect x="0" y="0" width="200" height="120" fill="#ffebee" stroke="#e74c3c" stroke-width="2" rx="5"/>
    <text x="100" y="20" text-anchor="middle" font-family="Inter, sans-serif" font-size="14" font-weight="bold" fill="#e74c3c">
      POP（取り出し）
    </text>
    
    <!-- Before pop -->
    <g transform="translate(20, 30)">
      <rect x="0" y="40" width="60" height="15" fill="#3498db" rx="2"/>
      <rect x="0" y="25" width="60" height="15" fill="#27ae60" rx="2"/>
      <rect x="0" y="10" width="60" height="15" fill="#f39c12" rx="2"/>
      <rect x="0" y="-5" width="60" height="15" fill="#e74c3c" rx="2"/>
      <text x="30" y="50" text-anchor="middle" font-family="Inter, sans-serif" font-size="8" fill="white">1</text>
      <text x="30" y="35" text-anchor="middle" font-family="Inter, sans-serif" font-size="8" fill="white">2</text>
      <text x="30" y="20" text-anchor="middle" font-family="Inter, sans-serif" font-size="8" fill="white">3</text>
      <text x="30" y="5" text-anchor="middle" font-family="Inter, sans-serif" font-size="8" fill="white">4</text>
    </g>
    
    <!-- Arrow -->
    <path d="M 90 70 L 110 70" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <!-- After pop -->
    <g transform="translate(120, 30)">
      <rect x="0" y="40" width="60" height="15" fill="#3498db" rx="2"/>
      <rect x="0" y="25" width="60" height="15" fill="#27ae60" rx="2"/>
      <rect x="0" y="10" width="60" height="15" fill="#f39c12" rx="2"/>
      <text x="30" y="50" text-anchor="middle" font-family="Inter, sans-serif" font-size="8" fill="white">1</text>
      <text x="30" y="35" text-anchor="middle" font-family="Inter, sans-serif" font-size="8" fill="white">2</text>
      <text x="30" y="20" text-anchor="middle" font-family="Inter, sans-serif" font-size="8" fill="white">3</text>
    </g>
    
    <text x="100" y="100" text-anchor="middle" font-family="Inter, sans-serif" font-size="11" fill="#e74c3c">
      value = stack.pop()
    </text>
  </g>
  
  <!-- Python implementation -->
  <text x="50" y="330" font-family="Inter, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
    Pythonでの実装例
  </text>
  
  <rect x="50" y="340" width="700" height="180" fill="#2c3e50" stroke="#34495e" stroke-width="2" rx="5"/>
  
  <!-- Code -->
  <text x="70" y="365" font-family="Consolas, monospace" font-size="12" fill="#f8f9fa">
    # スタックはリストで簡単に実装できる
  </text>
  <text x="70" y="385" font-family="Consolas, monospace" font-size="12" fill="#f8f9fa">
    stack = []  # 空のスタックを作成
  </text>
  <text x="70" y="405" font-family="Consolas, monospace" font-size="12" fill="#f8f9fa">
    
  </text>
  <text x="70" y="425" font-family="Consolas, monospace" font-size="12" fill="#f8f9fa">
    # PUSH操作：要素を追加
  </text>
  <text x="70" y="445" font-family="Consolas, monospace" font-size="12" fill="#27ae60">
    stack.append(1)    # [1]
  </text>
  <text x="70" y="465" font-family="Consolas, monospace" font-size="12" fill="#27ae60">
    stack.append(2)    # [1, 2]
  </text>
  <text x="70" y="485" font-family="Consolas, monospace" font-size="12" fill="#27ae60">
    stack.append(3)    # [1, 2, 3]
  </text>
  
  <text x="400" y="425" font-family="Consolas, monospace" font-size="12" fill="#f8f9fa">
    # POP操作：最新の要素を取り出し
  </text>
  <text x="400" y="445" font-family="Consolas, monospace" font-size="12" fill="#e74c3c">
    top = stack.pop()  # top=3, stack=[1, 2]
  </text>
  <text x="400" y="465" font-family="Consolas, monospace" font-size="12" fill="#e74c3c">
    top = stack.pop()  # top=2, stack=[1]
  </text>
  <text x="400" y="485" font-family="Consolas, monospace" font-size="12" fill="#e74c3c">
    top = stack.pop()  # top=1, stack=[]
  </text>
  
  <text x="70" y="505" font-family="Consolas, monospace" font-size="12" fill="#f8f9fa">
    # 空かどうかの確認
  </text>
  <text x="400" y="505" font-family="Consolas, monospace" font-size="12" fill="#3498db">
    if stack:  # 要素があるかチェック
  </text>
  
  <!-- Use cases -->
  <text x="50" y="550" font-family="Inter, sans-serif" font-size="14" font-weight="bold" fill="#2c3e50">
    スタックの活用場面
  </text>
  <text x="70" y="570" font-family="Inter, sans-serif" font-size="12" fill="#2c3e50">
    • 括弧の対応チェック • 関数呼び出しの管理 • アンドゥ機能 • 深さ優先探索（DFS）
  </text>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
     refX="0" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2c3e50"/>
    </marker>
  </defs>
</svg>