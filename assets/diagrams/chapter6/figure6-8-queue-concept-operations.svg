<svg viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
  <title>図6-8：キューの概念と操作</title>
  <desc>キューデータ構造の基本概念とenqueue/dequeue操作の可視化</desc>

  <!-- Background -->
  <rect width="800" height="600" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" font-family="Inter, sans-serif" font-size="18" font-weight="bold" fill="#2c3e50">
    図6-8：キューの概念と操作
  </text>
  
  <!-- Queue description -->
  <rect x="50" y="50" width="700" height="60" fill="#e8f4fd" stroke="#3498db" stroke-width="2" rx="5"/>
  <text x="70" y="75" font-family="Inter, sans-serif" font-size="14" font-weight="600" fill="#2980b9">
    🚶‍♂️ キュー（Queue）= 「先入れ先出し」(FIFO: First In, First Out)
  </text>
  <text x="70" y="95" font-family="Inter, sans-serif" font-size="12" fill="#2980b9">
    行列のように、最初に並んだ人が最初にサービスを受ける構造
  </text>
  
  <!-- Visual representation -->
  <g transform="translate(150, 140)">
    <!-- Queue container -->
    <rect x="0" y="30" width="400" height="60" fill="white" stroke="#34495e" stroke-width="3" rx="5"/>
    
    <!-- Queue items -->
    <rect x="10" y="40" width="80" height="40" fill="#3498db" stroke="#2980b9" stroke-width="2" rx="3"/>
    <text x="50" y="65" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" font-weight="bold" fill="white">
      データ1
    </text>
    
    <rect x="100" y="40" width="80" height="40" fill="#27ae60" stroke="#229954" stroke-width="2" rx="3"/>
    <text x="140" y="65" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" font-weight="bold" fill="white">
      データ2
    </text>
    
    <rect x="190" y="40" width="80" height="40" fill="#f39c12" stroke="#e67e22" stroke-width="2" rx="3"/>
    <text x="230" y="65" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" font-weight="bold" fill="white">
      データ3
    </text>
    
    <rect x="280" y="40" width="80" height="40" fill="#e74c3c" stroke="#c0392b" stroke-width="2" rx="3"/>
    <text x="320" y="65" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" font-weight="bold" fill="white">
      データ4
    </text>
    
    <!-- Front and Rear pointers -->
    <path d="M 50 20 L 50 35" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="50" y="15" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" font-weight="600" fill="#2c3e50">
      FRONT (先頭)
    </text>
    
    <path d="M 370 100 L 370 85" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="370" y="115" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" font-weight="600" fill="#2c3e50">
      REAR (末尾)
    </text>
    
    <!-- Direction arrow -->
    <path d="M 420 60 L 460 60" stroke="#9b59b6" stroke-width="3" marker-end="url(#arrowhead-purple)"/>
    <text x="480" y="65" font-family="Inter, sans-serif" font-size="12" font-weight="600" fill="#9b59b6">
      出る方向
    </text>
    
    <!-- Labels -->
    <text x="200" y="0" text-anchor="middle" font-family="Inter, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
      キューの構造
    </text>
    <text x="200" y="140" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" fill="#7f8c8d">
      左から入って、左から出る
    </text>
  </g>
  
  <!-- Operations -->
  <text x="400" y="200" font-family="Inter, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
    基本操作
  </text>
  
  <!-- Enqueue operation -->
  <g transform="translate(80, 220)">
    <rect x="0" y="0" width="300" height="140" fill="#e8f5e8" stroke="#27ae60" stroke-width="2" rx="5"/>
    <text x="150" y="20" text-anchor="middle" font-family="Inter, sans-serif" font-size="14" font-weight="bold" fill="#27ae60">
      ENQUEUE（末尾に追加）
    </text>
    
    <!-- Before enqueue -->
    <g transform="translate(20, 35)">
      <rect x="0" y="0" width="200" height="30" fill="white" stroke="#34495e" stroke-width="2" rx="3"/>
      <rect x="5" y="5" width="40" height="20" fill="#3498db" rx="2"/>
      <rect x="50" y="5" width="40" height="20" fill="#27ae60" rx="2"/>
      <rect x="95" y="5" width="40" height="20" fill="#f39c12" rx="2"/>
      <text x="25" y="18" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="white">1</text>
      <text x="70" y="18" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="white">2</text>
      <text x="115" y="18" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="white">3</text>
    </g>
    
    <!-- Arrow -->
    <path d="M 230 50 L 260 50" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
    <rect x="240" y="30" width="25" height="20" fill="#e74c3c" stroke="#c0392b" stroke-width="2" rx="2"/>
    <text x="252" y="43" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="white">4</text>
    <text x="252" y="20" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="#e74c3c">NEW</text>
    
    <!-- After enqueue -->
    <g transform="translate(20, 80)">
      <rect x="0" y="0" width="240" height="30" fill="white" stroke="#34495e" stroke-width="2" rx="3"/>
      <rect x="5" y="5" width="40" height="20" fill="#3498db" rx="2"/>
      <rect x="50" y="5" width="40" height="20" fill="#27ae60" rx="2"/>
      <rect x="95" y="5" width="40" height="20" fill="#f39c12" rx="2"/>
      <rect x="140" y="5" width="40" height="20" fill="#e74c3c" rx="2"/>
      <text x="25" y="18" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="white">1</text>
      <text x="70" y="18" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="white">2</text>
      <text x="115" y="18" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="white">3</text>
      <text x="160" y="18" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="white">4</text>
    </g>
    
    <text x="150" y="130" text-anchor="middle" font-family="Inter, sans-serif" font-size="11" fill="#27ae60">
      queue.append(4)
    </text>
  </g>
  
  <!-- Dequeue operation -->
  <g transform="translate(420, 220)">
    <rect x="0" y="0" width="300" height="140" fill="#ffebee" stroke="#e74c3c" stroke-width="2" rx="5"/>
    <text x="150" y="20" text-anchor="middle" font-family="Inter, sans-serif" font-size="14" font-weight="bold" fill="#e74c3c">
      DEQUEUE（先頭から取り出し）
    </text>
    
    <!-- Before dequeue -->
    <g transform="translate(20, 35)">
      <rect x="0" y="0" width="240" height="30" fill="white" stroke="#34495e" stroke-width="2" rx="3"/>
      <rect x="5" y="5" width="40" height="20" fill="#3498db" rx="2"/>
      <rect x="50" y="5" width="40" height="20" fill="#27ae60" rx="2"/>
      <rect x="95" y="5" width="40" height="20" fill="#f39c12" rx="2"/>
      <rect x="140" y="5" width="40" height="20" fill="#e74c3c" rx="2"/>
      <text x="25" y="18" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="white">1</text>
      <text x="70" y="18" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="white">2</text>
      <text x="115" y="18" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="white">3</text>
      <text x="160" y="18" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="white">4</text>
    </g>
    
    <!-- Arrow and removed item -->
    <path d="M 25 50 L 25 70" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
    <rect x="10" y="55" width="25" height="20" fill="#3498db" stroke="#2980b9" stroke-width="2" rx="2"/>
    <text x="22" y="68" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="white">1</text>
    <text x="50" y="68" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="#3498db">OUT</text>
    
    <!-- After dequeue -->
    <g transform="translate(60, 80)">
      <rect x="0" y="0" width="200" height="30" fill="white" stroke="#34495e" stroke-width="2" rx="3"/>
      <rect x="5" y="5" width="40" height="20" fill="#27ae60" rx="2"/>
      <rect x="50" y="5" width="40" height="20" fill="#f39c12" rx="2"/>
      <rect x="95" y="5" width="40" height="20" fill="#e74c3c" rx="2"/>
      <text x="25" y="18" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="white">2</text>
      <text x="70" y="18" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="white">3</text>
      <text x="115" y="18" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="white">4</text>
    </g>
    
    <text x="150" y="130" text-anchor="middle" font-family="Inter, sans-serif" font-size="11" fill="#e74c3c">
      value = queue.popleft()
    </text>
  </g>
  
  <!-- Python implementation -->
  <text x="50" y="390" font-family="Inter, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
    Pythonでの実装例
  </text>
  
  <rect x="50" y="400" width="700" height="140" fill="#2c3e50" stroke="#34495e" stroke-width="2" rx="5"/>
  
  <!-- Code -->
  <text x="70" y="425" font-family="Consolas, monospace" font-size="12" fill="#f8f9fa">
    from collections import deque  # 効率的なキューの実装
  </text>
  <text x="70" y="445" font-family="Consolas, monospace" font-size="12" fill="#f8f9fa">
    
  </text>
  <text x="70" y="465" font-family="Consolas, monospace" font-size="12" fill="#f8f9fa">
    queue = deque()  # 空のキューを作成
  </text>
  <text x="70" y="485" font-family="Consolas, monospace" font-size="12" fill="#f8f9fa">
    
  </text>
  <text x="70" y="505" font-family="Consolas, monospace" font-size="12" fill="#27ae60">
    queue.append(1)      # [1] - 末尾に追加
  </text>
  <text x="70" y="525" font-family="Consolas, monospace" font-size="12" fill="#27ae60">
    queue.append(2)      # [1, 2] - 末尾に追加
  </text>
  
  <text x="400" y="465" font-family="Consolas, monospace" font-size="12" fill="#e74c3c">
    first = queue.popleft()  # first=1, queue=[2]
  </text>
  <text x="400" y="485" font-family="Consolas, monospace" font-size="12" fill="#e74c3c">
    first = queue.popleft()  # first=2, queue=[]
  </text>
  <text x="400" y="505" font-family="Consolas, monospace" font-size="12" fill="#f8f9fa">
    
  </text>
  <text x="400" y="525" font-family="Consolas, monospace" font-size="12" fill="#3498db">
    if queue:  # 空かどうかの確認
  </text>
  
  <!-- Use cases -->
  <text x="50" y="570" font-family="Inter, sans-serif" font-size="14" font-weight="bold" fill="#2c3e50">
    キューの活用場面
  </text>
  <text x="70" y="590" font-family="Inter, sans-serif" font-size="12" fill="#2c3e50">
    • 順番待ち処理 • 幅優先探索（BFS） • タスクの順次実行 • バッファリング
  </text>
  
  <!-- Arrow marker definitions -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
     refX="0" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2c3e50"/>
    </marker>
    <marker id="arrowhead-purple" markerWidth="10" markerHeight="7" 
     refX="0" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#9b59b6"/>
    </marker>
  </defs>
</svg>