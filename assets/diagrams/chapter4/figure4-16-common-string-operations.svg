<svg viewBox="0 0 800 700" xmlns="http://www.w3.org/2000/svg">
  <title>図4-16：競技プログラミングでよく使う文字列操作</title>
  <desc>文字の出現回数、回文判定、文字列加工など実践的な文字列操作を示す図</desc>
  
  <defs>
    <style>
      .title { font: 600 16px Inter, sans-serif; fill: #1F2937; }
      .section-title { font: 600 14px Inter, sans-serif; fill: #374151; }
      .code-text { font: 500 10px 'Monaco', 'Menlo', monospace; fill: #4B5563; }
      .result-text { font: 600 10px 'Monaco', 'Menlo', monospace; }
      .comment-text { font: 500 9px Inter, sans-serif; fill: #6B7280; }
      .example-text { font: 600 11px Inter, sans-serif; }
      .emoji { font: 400 16px Inter, sans-serif; }
      
      .count-section { fill: #DBEAFE; stroke: #3B82F6; stroke-width: 2; }
      .palindrome-section { fill: #ECFDF5; stroke: #22C55E; stroke-width: 2; }
      .transform-section { fill: #FEF3C7; stroke: #F59E0B; stroke-width: 2; }
      .code-box { fill: #F8FAFC; stroke: #CBD5E0; stroke-width: 1; }
      .result-box { fill: #FFFFFF; stroke: #9CA3AF; stroke-width: 1; }
    </style>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="700" fill="#FFFFFF"/>
  
  <!-- Title -->
  <text x="400" y="32" text-anchor="middle" class="title">図4-16：競技プログラミングでよく使う文字列操作</text>
  
  <!-- Character Count Section -->
  <g id="count-section">
    <rect x="50" y="60" width="700" height="180" rx="12" class="count-section"/>
    <text x="70" y="85" class="emoji">📊</text>
    <text x="95" y="85" class="section-title" fill="#1E40AF">パターン1：文字の出現回数カウント</text>
    
    <g transform="translate(70, 105)">
      <rect x="0" y="0" width="160" height="12" rx="3" class="code-box"/>
      <text x="5" y="9" class="code-text">s = input()  # "programming"</text>
      
      <rect x="0" y="17" width="140" height="12" rx="3" class="code-box"/>
      <text x="5" y="26" class="code-text">char_count = {}</text>
      
      <rect x="0" y="34" width="120" height="12" rx="3" class="code-box"/>
      <text x="5" y="43" class="code-text">for char in s:</text>
      
      <rect x="0" y="51" width="180" height="12" rx="3" class="code-box"/>
      <text x="5" y="60" class="code-text">    if char in char_count:</text>
      
      <rect x="0" y="68" width="200" height="12" rx="3" class="code-box"/>
      <text x="5" y="77" class="code-text">        char_count[char] += 1</text>
      
      <rect x="0" y="85" width="120" height="12" rx="3" class="code-box"/>
      <text x="5" y="94" class="code-text">    else:</text>
      
      <rect x="0" y="102" width="200" height="12" rx="3" class="code-box"/>
      <text x="5" y="111" class="code-text">        char_count[char] = 1</text>
      
      <rect x="0" y="119" width="160" height="12" rx="3" class="code-box"/>
      <text x="5" y="128" class="code-text">print(char_count)</text>
      
      <!-- Result -->
      <rect x="250" y="0" width="420" height="40" rx="6" class="result-box"/>
      <text x="260" y="15" class="comment-text">結果：</text>
      <text x="260" y="30" class="result-text" fill="#3B82F6" style="font-size: 9px;">{'p':1, 'r':2, 'o':1, 'g':2, 'a':1, 'm':2, 'i':1, 'n':1}</text>
      
      <!-- Simpler version -->
      <text x="250" y="65" class="comment-text">より簡潔な書き方：</text>
      <rect x="250" y="70" width="280" height="12" rx="3" class="code-box"/>
      <text x="255" y="79" class="code-text">from collections import Counter</text>
      
      <rect x="250" y="85" width="180" height="12" rx="3" class="code-box"/>
      <text x="255" y="94" class="code-text">char_count = Counter(s)</text>
    </g>
  </g>
  
  <!-- Palindrome Section -->
  <g id="palindrome-section">
    <rect x="50" y="260" width="700" height="140" rx="12" class="palindrome-section"/>
    <text x="70" y="285" class="emoji">🔄</text>
    <text x="95" y="285" class="section-title" fill="#059669">パターン2：回文（palindrome）判定</text>
    
    <g transform="translate(70, 305)">
      <rect x="0" y="0" width="160" height="12" rx="3" class="code-box"/>
      <text x="5" y="9" class="code-text">s = input()  # "racecar"</text>
      
      <rect x="0" y="17" width="140" height="12" rx="3" class="code-box"/>
      <text x="5" y="26" class="code-text">if s == s[::-1]:</text>
      
      <rect x="0" y="34" width="160" height="12" rx="3" class="code-box"/>
      <text x="5" y="43" class="code-text">    print("回文です")</text>
      
      <rect x="0" y="51" width="80" height="12" rx="3" class="code-box"/>
      <text x="5" y="60" class="code-text">else:</text>
      
      <rect x="0" y="68" width="220" height="12" rx="3" class="code-box"/>
      <text x="5" y="77" class="code-text">    print("回文ではありません")</text>
      
      <!-- Case insensitive version -->
      <text x="300" y="15" class="comment-text">大文字小文字を区別しない回文判定：</text>
      <rect x="300" y="25" width="180" height="12" rx="3" class="code-box"/>
      <text x="305" y="34" class="code-text">s = input().lower()</text>
      
      <rect x="300" y="42" width="140" height="12" rx="3" class="code-box"/>
      <text x="305" y="51" class="code-text">if s == s[::-1]:</text>
      
      <rect x="300" y="59" width="240" height="12" rx="3" class="code-box"/>
      <text x="305" y="68" class="code-text">    print("回文です（大小文字無視）")</text>
    </g>
  </g>
  
  <!-- String Transformation Section -->
  <g id="transform-section">
    <rect x="50" y="420" width="700" height="180" rx="12" class="transform-section"/>
    <text x="70" y="445" class="emoji">🔧</text>
    <text x="95" y="445" class="section-title" fill="#D97706">パターン3：文字列の置換・加工</text>
    
    <g transform="translate(70, 465)">
      <rect x="0" y="0" width="180" height="12" rx="3" class="code-box"/>
      <text x="5" y="9" class="code-text">s = input()  # "Hello World"</text>
      
      <rect x="0" y="17" width="200" height="12" rx="3" class="code-box"/>
      <text x="5" y="26" class="code-text">s = s.replace(" ", "_")</text>
      <text x="210" y="26" class="comment-text">→ "Hello_World"</text>
      
      <rect x="0" y="34" width="200" height="12" rx="3" class="code-box"/>
      <text x="5" y="43" class="code-text">s = s.replace("o", "0")</text>
      <text x="210" y="43" class="comment-text">→ "Hell0_W0rld"</text>
      
      <rect x="0" y="51" width="120" height="12" rx="3" class="code-box"/>
      <text x="5" y="60" class="code-text">s = s.lower()</text>
      <text x="130" y="60" class="comment-text">→ "hell0_w0rld"</text>
      
      <rect x="0" y="68" width="160" height="12" rx="3" class="code-box"/>
      <text x="5" y="77" class="code-text">words = s.split("_")</text>
      <text x="170" y="77" class="comment-text">→ ["hell0", "w0rld"]</text>
      
      <rect x="0" y="85" width="180" height="12" rx="3" class="code-box"/>
      <text x="5" y="94" class="code-text">print("_".join(words))</text>
      <text x="190" y="94" class="comment-text">→ "hell0_w0rld"</text>
      
      <!-- Other useful operations -->
      <rect x="350" y="0" width="320" height="120" rx="6" fill="#FFFBEB" stroke="#F59E0B" stroke-width="1"/>
      <text x="360" y="15" class="example-text" fill="#D97706">その他の便利な操作：</text>
      
      <rect x="360" y="25" width="180" height="10" rx="2" class="code-box"/>
      <text x="365" y="32" class="code-text" style="font-size: 9px;">s.startswith("Hello")</text>
      <text x="550" y="32" class="comment-text" style="font-size: 9px;">先頭判定</text>
      
      <rect x="360" y="40" width="160" height="10" rx="2" class="code-box"/>
      <text x="365" y="47" class="code-text" style="font-size: 9px;">s.endswith("rld")</text>
      <text x="530" y="47" class="comment-text" style="font-size: 9px;">末尾判定</text>
      
      <rect x="360" y="55" width="120" height="10" rx="2" class="code-box"/>
      <text x="365" y="62" class="code-text" style="font-size: 9px;">s.count("l")</text>
      <text x="490" y="62" class="comment-text" style="font-size: 9px;">特定文字数</text>
      
      <rect x="360" y="70" width="140" height="10" rx="2" class="code-box"/>
      <text x="365" y="77" class="code-text" style="font-size: 9px;">s.find("World")</text>
      <text x="510" y="77" class="comment-text" style="font-size: 9px;">位置検索</text>
      
      <rect x="360" y="85" width="120" height="10" rx="2" class="code-box"/>
      <text x="365" y="92" class="code-text" style="font-size: 9px;">s.isdigit()</text>
      <text x="490" y="92" class="comment-text" style="font-size: 9px;">数字判定</text>
      
      <rect x="360" y="100" width="120" height="10" rx="2" class="code-box"/>
      <text x="365" y="107" class="code-text" style="font-size: 9px;">s.isalpha()</text>
      <text x="490" y="107" class="comment-text" style="font-size: 9px;">文字判定</text>
    </g>
  </g>
  
  <!-- Tips -->
  <g id="tips">
    <rect x="100" y="620" width="600" height="70" rx="8" fill="#F0F9FF" stroke="#0EA5E9" stroke-width="2"/>
    <text x="120" y="645" class="emoji">💡</text>
    <text x="150" y="645" class="example-text" fill="#0C4A6E">文字列操作のコツ</text>
    
    <g transform="translate(120, 660)">
      <circle cx="8" cy="8" r="3" fill="#22C55E"/>
      <text x="20" y="12" class="comment-text" fill="#0C4A6E">文字数カウントはCounterが便利　• 回文判定はスライス[::-1]を活用</text>
      
      <circle cx="8" cy="23" r="3" fill="#22C55E"/>
      <text x="20" y="27" class="comment-text" fill="#0C4A6E">replace(), split(), join()を組み合わせて文字列を加工　• 大小文字変換も忘れずに</text>
    </g>
  </g>
  
</svg>