<!-- Canonical Sidebar Navigation Template (data-driven) -->
<div class="sidebar-content">
  <div class="book-info">
    <h2 class="book-title">{{ site.title | escape }}</h2>
    {% if site.description %}
    <p class="book-subtitle">{{ site.description | escape }}</p>
    {% endif %}
  </div>

  <div class="toc">
    <div class="toc-section">
      <ul class="toc-list">
        <li class="toc-item">
          <a href="{{ '/' | relative_url }}" class="toc-link {% if page.url == '/' %}active{% endif %}">ãƒˆãƒƒãƒ—</a>
        </li>
      </ul>
    </div>

    {% assign nav = site.data.navigation %}
    {% if nav and nav.chapters %}
      <div class="toc-section">
        <h3 class="toc-section-title">ç›®æ¬¡</h3>
        <ul class="toc-list">
          {% for item in nav.chapters %}
          <li class="toc-item toc-chapter">
            <a href="{{ item.path | relative_url }}" class="toc-link {% if page.url contains item.path %}active{% endif %}">{{ item.title }}</a>
          </li>
          {% endfor %}
        </ul>
      </div>
    {% else %}
      {%- comment -%} Fallback: auto-generate from pages when data missing {%- endcomment -%}
      {% assign pages = site.pages | where_exp: "p", "p.url contains '/src/'" | sort: 'order' %}
      {% if pages and pages.size > 0 %}
      <div class="toc-section">
        <h3 class="toc-section-title">ç›®æ¬¡</h3>
        <ul class="toc-list">
          {% for p in pages %}
          <li class="toc-item toc-chapter">
            <a href="{{ p.url | relative_url }}" class="toc-link {% if page.url == p.url %}active{% endif %}">{{ p.title }}</a>
          </li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}
    {% endif %}

    {% if nav and nav.appendices and nav.appendices.size > 0 %}
      <div class="toc-section">
        <h3 class="toc-section-title">ä»˜éŒ²</h3>
        <ul class="toc-list">
          {% for item in nav.appendices %}
          <li class="toc-item">
            <a href="{{ item.path | relative_url }}" class="toc-link {% if page.url contains item.path %}active{% endif %}">{{ item.title }}</a>
          </li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}
  </div>

  <div class="sidebar-footer">
    <div class="external-links">
      {% if site.repository %}
      <a href="{% if site.repository contains 'http' %}{{ site.repository }}{% else %}https://github.com/{{ site.repository }}{% endif %}"
         target="_blank" rel="noopener" class="external-link">ðŸ’¾ GitHub</a>
      {% endif %}
    </div>
  </div>
</div>
